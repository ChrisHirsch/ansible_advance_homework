---
# Provision the app-tier 
# This will install Tomcat and it's associated filesystem
- name: Install Packages for App Tier
  loop: "{{ app_tier_packages }}"
  yum:
    name: "{{ item }}"
    state: present

- name: Create Ansible tomcat directory
  file:
      path: /usr/share/tomcat/webapps/ROOT
      state: directory
  notify:
    - restart tomcat

- name: "Install application template for {{ inventory_hostname }}"
  template:
    src: "index.html.j2"
    dest: /usr/share/tomcat/webapps/ROOT/index.html
    mode: 0644
  notify:
    - restart tomcat

- name: start and enable tomcat
  service:
    name: tomcat
    state: started
    enabled: yes